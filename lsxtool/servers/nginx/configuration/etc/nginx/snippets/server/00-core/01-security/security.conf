# Configuración de seguridad para Nginx

# Ocultar versión de Nginx
server_tokens off;

# Configuración de rate limiting
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s;
limit_req_zone $binary_remote_addr zone=static:10m rate=30r/s;

# Configuración de timeouts
client_body_timeout 10s;
client_header_timeout 10s;
send_timeout 10s;

# Configuración de buffers
client_body_buffer_size 128k;
client_header_buffer_size 1k;
large_client_header_buffers 4 4k;

# Configuración de seguridad adicional
client_max_body_size 50M;
client_body_in_file_only off;
client_body_in_single_buffer on;
client_body_temp_path /tmp/nginx_client_body_temp;

# Configuración de proxy
proxy_connect_timeout 60s;
proxy_send_timeout 60s;
proxy_read_timeout 60s;
proxy_buffer_size 4k;
proxy_buffers 8 4k;
proxy_busy_buffers_size 8k;
proxy_temp_file_write_size 8k;
proxy_temp_path /tmp/nginx_proxy_temp;
proxy_cache_path /tmp/nginx_cache levels=1:2 keys_zone=cache:10m max_size=100m inactive=60m;
