# Configuración para insejupy-temporal.yucatan.gob.mx - Apache Puerto 9200
# Aplicación PHP - estructura public/app

<VirtualHost *:9200>
    ServerName insejupy-temporal.yucatan.gob.mx

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/insejupy-temporal-error.log
    CustomLog ${APACHE_LOG_DIR}/insejupy-temporal-access.log combined

    # Root de la aplicación PHP
    DocumentRoot /mnt/d/www/01-STIC/web/insejupy-temp/application/public
    DirectoryIndex prueba.php index.php index.html index.htm

    # --- Directorio público ---
    <Directory /mnt/d/www/01-STIC/web/insejupy-temp/application/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted

        # PHP-FPM para archivos PHP (PHP 8.2)
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.2-fpm.sock|fcgi://localhost/"
        </FilesMatch>
    </Directory>

    # --- Proteger directorio de aplicación ---
    <Directory /mnt/d/www/01-STIC/web/insejupy-temp/application/app>
        Require all denied
    </Directory>

    # Archivos estáticos (con caché y tipos MIME correctos)
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        # Asegurar tipo MIME correcto para CSS
        <If "%{REQUEST_URI} =~ /\.css$/">
            ForceType text/css
        </If>
        # Asegurar tipo MIME correcto para JS
        <If "%{REQUEST_URI} =~ /\.js$/">
            ForceType application/javascript
        </If>
        # Caché para archivos estáticos
        Header set Cache-Control "public, max-age=31536000, immutable"
        ExpiresActive On
        ExpiresDefault "access plus 1 year"
    </LocationMatch>
</VirtualHost>


