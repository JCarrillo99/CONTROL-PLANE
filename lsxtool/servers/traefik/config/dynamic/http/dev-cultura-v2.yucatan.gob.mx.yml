# Configuración para dev-cultura-v2.yucatan.gob.mx - Traefik 3.4
# Modo LOCAL: Traefik apunta a Apache en puerto 9200 que sirve aplicación Vue (template-vue)
# PHP 7.4-FPM

http:
  routers:
    # Router HTTP - redirige a HTTPS
    dev-cultura-v2-http:
      rule: "Host(`dev-cultura-v2.yucatan.gob.mx`)"
      service: apache-9200-cultura-v2
      entryPoints:
        - web
      middlewares:
        - redirect-to-https
      priority: 100

    # Router HTTPS - iframes mismo origen: strip cualquier X-Frame-Options del backend, luego fijar SAMEORIGIN
    dev-cultura-v2-main:
      rule: "Host(`dev-cultura-v2.yucatan.gob.mx`)"
      service: apache-9200-cultura-v2
      entryPoints:
        - websecure
      middlewares:
        - security-headers-no-frame
        - frame-strip
        - frame-allow-sameorigin
        - compress
      priority: 100
      tls:
        certResolver: letsencrypt

  services:
    # Servicio Apache local - Puerto 9200 (serviendo aplicación Vue)
    apache-9200-cultura-v2:
      loadBalancer:
        servers:
          - url: "http://localhost:9200"
        passHostHeader: true

